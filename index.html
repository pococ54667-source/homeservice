<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home Services</title>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f2f2f2;
}

.wrapper{
  max-width:800px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}

/* TOP */
h1{margin-bottom:5px;}
.services{color:#666;margin-bottom:20px;}

/* BOOKING */
.booking{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:20px;
}

select,button{
  padding:10px;
  font-size:15px;
  border-radius:5px;
  border:1px solid #ccc;
}

button{
  background:#007bff;
  color:#fff;
  border:none;
  cursor:pointer;
}

/* PROVIDERS */
.provider{
  border:1px solid #ddd;
  padding:12px;
  border-radius:6px;
  margin-bottom:10px;
  background:#fafafa;
}

/* FOOTER */
footer{
  margin-top:30px;
  background:#222;
  color:#ccc;
  padding:20px;
  font-size:14px;
}
footer h3{color:#fff;margin-top:15px;}
</style>
</head>

<body>

<div class="wrapper">
  <h1>Home Services</h1>
  <div class="services">
    Plumber | Electrician | AC Repair | Carpenter | Cleaning
  </div>

  <!-- BOOKING -->
  <div class="booking">
    <select id="citySelect">
      <option value="">Select City</option>
    </select>

    <select id="serviceSelect">
      <option value="">Select Service</option>
    </select>

    <button id="searchBtn">Book Service</button>
  </div>

  <!-- RESULT -->
  <div id="providers"></div>
</div>

<footer>
  <h3>Customer Support</h3>
  <p>Email: support@homeservices.com</p>
  <p>Phone: +91 9939496099</p>

  <h3>About Us</h3>
  <p>
    Home Services connects customers with local service providers.
    We are only a listing platform.
  </p>

  <h3>Disclaimer</h3>
  <p>
    We are not responsible for service quality or pricing.
  </p>
</footer>

<script>
/* SUPABASE */
const supabaseClient = supabase.createClient(
  "https://hjpvadozhrdjugfrcffv.supabase.co",
  "sb_publishable_VWRFCLxoBE75MYve7W5jhw_PedtT83O"
);

/* LOAD CITIES */
async function loadCities(){
  const { data } = await supabaseClient
    .from("providers")
    .select("city")
    .neq("city", null);

  const cities = [...new Set(data.map(x => x.city))];
  cities.forEach(c=>{
    citySelect.innerHTML += `<option value="${c}">${c}</option>`;
  });
}

/* LOAD SERVICES */
async function loadServices(){
  const { data } = await supabaseClient
    .from("providers")
    .select("service")
    .neq("service", null);

  const services = [...new Set(data.map(x => x.service))];
  services.forEach(s=>{
    serviceSelect.innerHTML += `<option value="${s}">${s}</option>`;
  });
}

/* SEARCH */
searchBtn.onclick = async () => {
  providers.innerHTML = "Loading...";

  const city = citySelect.value;
  const service = serviceSelect.value;

  const { data } = await supabaseClient
    .from("providers")
    .select("*")
    .eq("city", city)
    .eq("service", service)
    .limit(20);

  providers.innerHTML = "";

  if(!data || data.length === 0){
    providers.innerHTML = "No providers found";
    return;
  }

  data.forEach(p=>{
    providers.innerHTML += `
      <div class="provider">
        <b>${p.name}</b><br>
        City: ${p.city}<br>
        Service: ${p.service}<br>
        Phone: ${p.phone || "N/A"}
      </div>
    `;
  });
};

/* INIT */
loadCities();
loadServices();
</script>

</body>
</html>

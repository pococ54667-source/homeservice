  <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home Services</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f2f2f2;
}

.app{
  max-width:420px;
  margin:20px auto;
  background:#fff;
  border-radius:10px;
  overflow:hidden;
}

.content{
  padding:16px;
}

h2{margin-top:0}

/* LIST BUTTONS */
.list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:15px;
}

.list button{
  padding:10px 14px;
  border-radius:20px;
  border:1px solid #ccc;
  background:#fafafa;
  font-size:14px;
}

.list button.active{
  background:#007bff;
  color:#fff;
  border:none;
}

/* PROVIDER */
.provider{
  border:1px solid #ddd;
  padding:10px;
  border-radius:6px;
  margin-bottom:10px;
}

/* FOOTER */
footer{
  background:#222;
  color:#ccc;
  padding:14px;
  font-size:14px;
}
footer h3{color:#fff;margin-top:0}
</style>
</head>

<body>

<div class="app">

  <div class="content">
    <h2>Home Services</h2>
    <p>Choose City & Service</p>

    <h4>City</h4>
    <div class="list" id="cityList"></div>

    <h4>Service</h4>
    <div class="list" id="serviceList"></div>

    <div id="providers"></div>
  </div>

  <footer>
    <h3>Customer Support</h3>
    <p>Email: support@homeservices.com</p>
    <p>Phone: +91 9939496099</p>
  </footer>

</div>

<script>
const { createClient } = supabase;

const db = createClient(
  "https://hjpvadozhrdjugfrcffv.supabase.co",
  "sb_publishable_VWRFCLxoBE75MYve7W5jhw_PedtT83O"
);

let selectedCity = "";
let selectedService = "";

/* LOAD CITIES */
async function loadCities(){
  const { data } = await db.from("providers").select("city");
  [...new Set(data.map(d=>d.city))].forEach(c=>{
    const btn = document.createElement("button");
    btn.innerText = c;
    btn.onclick = ()=>{
      document.querySelectorAll("#cityList button").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      selectedCity = c;
      loadProviders();
    };
    cityList.appendChild(btn);
  });
}

/* LOAD SERVICES */
async function loadServices(){
  const { data } = await db.from("providers").select("service");
  [...new Set(data.map(d=>d.service))].forEach(s=>{
    const btn = document.createElement("button");
    btn.innerText = s;
    btn.onclick = ()=>{
      document.querySelectorAll("#serviceList button").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      selectedService = s;
      loadProviders();
    };
    serviceList.appendChild(btn);
  });
}

/* LOAD PROVIDERS */
async function loadProviders(){
  if(!selectedCity || !selectedService) return;

  providers.innerHTML = "Loading...";

  const { data } = await db
    .from("providers")
    .select("*")
    .eq("city", selectedCity)
    .eq("service", selectedService);

  providers.innerHTML = "";
  if(!data.length){
    providers.innerHTML = "No providers found";
    return;
  }

  data.forEach(p=>{
    providers.innerHTML += `
      <div class="provider">
        <b>${p.name}</b><br>
        ${p.city} â€¢ ${p.service}<br>
        ðŸ“ž ${p.phone}
      </div>
    `;
  });
}

/* INIT */
loadCities();
loadServices();
</script>

</body>
</html>
